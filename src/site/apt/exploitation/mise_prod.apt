 -----
 SIRH
 -----
 Noémie NICOLAS
 -----
  26/03/2012

Mise en production d'une nouvelle version de SIRH

* Modifications sur la base de données

 En cas de modification à faire sur la BD avant le passage de l'EAR (fichier de mise à jour de SIRH), il faut préparer les requêtes SQL correspondant aux modifications et créer une Demande d'Intervention afin que le SIE passe ces modifications sur la base de données de production.
 
 ** Opérations effectuées par le SIE
 
  * Arrêt de l'application SIRH
  
  * Sauvegarde du schéma SIRH ( Création d’un fichier de sauvegarde sur disk : CRTSAVF FILE(FILESAVE/SIRHSAV) TEXT('SAuvegarde SIRH du XX/XX/XXXX) puis Lancer la sauvegarde : SAVLIB LIB(SIRH) DEV(*SAVF) SAVF(SIRHSAV) PRECHK(*YES) )
  
  * S’assurer que des contraintes sur des fichiers de Mairie n’affectent pas la maj à faire
  
  * Arrêter la répli (si on souhaite conserver la dernière version en cours ) ceci est malgré tout facultatif car en cas de retour arrière (restauration de SIRH) la repli renverra la restauration sur la machine de backup
  
  * Passer le script SQL à l’aide de Iseries Navigator
  
  * Redémarrer l’appli
  
  * Tester la MAJ
  
	* ok : ne supprimer la sauvegarde que 24h plus tard
	
	* pas ok : arrêt de l'application SIRH puis Restauration des données : RSTLIB SAVLIB(SIRH) DEV(*SAVF) SAVF(SIRHSAV) MBROPT(*ALL) ALWOBJDIF(*ALL) puis redémarrage de l'application SIRH
 
 
 Une fois le retour de la DI, vérifier que toutes les requêtes ont été effectuées.
 
* Modifications de l'application

 Une fois toutes les modifications faites sur les fichiers de l'application , il faut exporter les sources SIRH via un EAR.
 
 Cet EAR doit être déposé dans SVPWAS/SIRH_PRODUCTION puis une DI doit être adressée au SIE avec le chemin de l'EAR à publier.
 
 Une fois le retour de la DI, vérifier en PROD que l'application contient bien les modifications souhaitées.
 