 -----
 SIRH
 -----
 NOémie NICOLAS
 -----
  06/06/2012
  
Procédures

* Installation de Tomcat, base de données AS400

** Récupération du driver jt400

	Il suffit de suivre la démarche suivante depuis un shell linux :
	
+------------------------------------------+
cd
mkdir jt400;
export JT400_version="6.7";
cd jt400;
wget -U NoSuchBrowser/1.0 http://repo1.maven.org/maven2/net/sf/jt400/jt400/$JT400_version/jt400-$JT400_version.jar
+------------------------------------------+	

** Installation du driver

	Sous linux :
	
+------------------------------------------+
export CATALINA_HOME=/apache-tomcat-7.0.27/
cp $HOME/jt400/jt400-$JT400_version.jar $CATALINA_HOME/lib
+------------------------------------------+

	A ce stade, le driver est bien déposé.


** Ajout du datasource

    Dans tomcat, le datasource se declare directement dans le repertoire META-INF de l'application.
	
	* Se positionner dans le répertoire META-INF de l'application 
	
	* Créer le fichier context.xml avec le contenu suivant :
	
+------------------------------------------+
<?xml version="1.0" encoding="UTF-8"?>
<Context>
	
	  <Resource name="jdbc/robinnw" auth="Container" type="javax.sql.DataSource"
               maxActive="100" maxIdle="30" minIdle="0" validationQuery="select 1 from sysibm.sysdummy1"   maxWait="10000" initialSize="1"
               username="adminwas" password="***REMOVED***" driverClassName="com.ibm.as400.access.AS400JDBCDriver"
               url="jdbc:as400://robinnw" poolPreparedStatements="true" />
</Context>
+------------------------------------------+	


** Vérification du fonctionnement de l'application
	
	Pour cela, il faut lancer le serveur tomcat	en command line :
	
+------------------------------------------+
cd $CATALINA_HOME/bin
startup.bat
+------------------------------------------+

	Déployer le war de l'application via la console admin tomcat (http://localhost:8080).
	
	Tester si l'application fontionne correctement.
